#!/usr/bin/env bash

# General
### neoVim
alias v='nvim'
### Tmux
alias t='tmux'
### Clear
alias c='clear'
### go to previous directory
alias ..='cd ..'
### do not turn off the screen
alias cafe='caffeinate -dims'
### Show ALIASes
alias salias='less ~/dotfiles/.aliases'
### List files in Long format with human-readable file sizes and colorized output
alias ll='ls -hl --color=auto'
### Display disk Usage in Human-readable format, depth 1, sorted by size
alias duh='du -h -d 1 | sort -hr'

# AWS
### AWs SSO Login
alias awssol='aws sso login --profile '
### aws Select Profile
alias awsp='source ~/dotfiles/scripts/aws_select_profile.sh'

# Vaults
### Change directory to Vault Personal
alias cvp='cd ~/vaults/vpersonal'
### Change directory to Vault Work 2
alias cvw2='cd ~/vaults/vwork2'
### Change directory to Vault Work 3
alias cvw3='cd ~/vaults/vwork3'

# Config/Dotfiles
### Change directory to Config folder
alias cc='cd ~/dotfiles'
### shell ReLoad zshrc
alias rlc='source ~/.zshrc'

# Podman
### Podman System Prune (all, volumes)
alias psp='podman system prune -a --volumes'
### Podman Machine Init
alias pmi='podman machine init --cpus=4 --memory=8192 --disk-size=50'
### Podman Machine Remove
alias pmr='podman machine rm'
### Podman Machine Start
alias pms='podman machine start'
### Podman Machine sTop
alias pmt='podman machine stop'

# Git, Github
### Git Remote Prune Origin
alias grpo='git remote prune origin'
## Git Switch User
alias gsu='gh auth switch && gh auth setup-git'
## Git create worktree AI Sandbox
gais() {
  local branch="$1"
  if [ -z "$branch" ]; then
    branch="$(git rev-parse --abbrev-ref HEAD 2>/dev/null)"
    if [ -z "$branch" ]; then
      echo "Error: No branch provided and unable to detect current branch."
      return 1
    fi
  fi

  local worktree_name
  if [ "$branch" = "HEAD" ]; then
    local current_branch
    current_branch="$(git rev-parse --abbrev-ref HEAD 2>/dev/null)"
    worktree_name="${current_branch}.HEAD.$(date +%s)"
  else
    worktree_name="$branch.$(date +%s)"
  fi

  local dir
  dir="${TMPDIR}/ai-sandbox/${worktree_name}"
  mkdir -p "$dir"

  # Handle HEAD specially
  if [ "$branch" = "HEAD" ]; then
    git worktree add "$dir" HEAD || return 1
  # Check if branch exists locally
  elif git show-ref --verify --quiet "refs/heads/$branch"; then
    git worktree add "$dir" "$branch" || return 1
  else
    # Check if branch exists on remote
    if git ls-remote --exit-code --heads origin "$branch" >/dev/null 2>&1; then
      git worktree add -b "$branch" "$dir" "origin/$branch" || return 1
    else
      git worktree add -b "$branch" "$dir" HEAD || return 1
    fi
  fi

  if [ -n "$BASH_VERSION" ]; then
    history -s "git worktree remove \"$worktree_name\""
  elif [ -n "$ZSH_VERSION" ]; then
    print -s -- "git worktree remove \"$worktree_name\""
  fi

  opencode "$dir"
}
## Github PRS
alias gprs='GH_FORCE_TTY=1 ~/dotfiles/scripts/github_prs.sh | less -R'
## Github Repos
alias grepos='~/dotfiles/scripts/github_repos.sh'
## Github Pull request Regression Review
alias gprr='~/dotfiles/scripts/github_pr_find_regressions.sh'

# Terraform
### TerraForm Plan
alias tf='terraform'
alias tfp='terraform plan'

# Go
### Go Run Main
alias grm='go run main.go'
### Go Run Dot
alias grd='go run .'
### Go Test All
alias gta='go test ./...'
